# Tauri + Vue + TypeScript

This template should help get you started developing with Vue 3 and TypeScript in Vite. The template uses Vue 3 `<script setup>` SFCs, check out the [script setup docs](https://v3.vuejs.org/api/sfc-script-setup.html#sfc-script-setup) to learn more.

## Recommended IDE Setup

- [VS Code](https://code.visualstudio.com/) + [Vue - Official](https://marketplace.visualstudio.com/items?itemName=Vue.volar) + [Tauri](https://marketplace.visualstudio.com/items?itemName=tauri-apps.tauri-vscode) + [rust-analyzer](https://marketplace.visualstudio.com/items?itemName=rust-lang.rust-analyzer)



# 开发环境

此项目使用Tauri + bun标准初始化方法创建,参数如下:

```
PS D:\Dev\SSMT4> bun create tauri-app
✔ Project name · ssmt4
✔ Identifier · ssmt4
✔ Choose which language to use for your frontend · TypeScript / JavaScript - (pnpm, yarn, npm, deno, bun)
✔ Choose your package manager · bun
✔ Choose your UI template · Vue - (https://vuejs.org/)
✔ Choose your UI flavor · TypeScript

Template created! To get started run:
  cd ssmt4
  bun install
  bun run tauri android init

For Desktop development, run:
  bun run tauri dev

For Android development, run:
  bun run tauri android dev

PS D:\Dev\SSMT4>
```

此项目仅在Windows上进行开发，使用版本为Windows11专业版

此项目仅使用VSCode进行开发

# Git Clone之后的操作

如果你的Windows电脑上没有bun环境的话，先运行如下代码进行初始化

`powershell -c "irm bun.sh/install.ps1 | iex"`

如果是在VSCode中打开的Terminal执行此命令，执行完毕后需要重启VSCode否则无法检测到bun命令

在VSCode中打开一个Terminal然后运行

`bun install`

这样就能把环境安装上，然后运行

`bun run tauri dev`

就能启动程序查看效果了

虽然我也使用MacOS，但是一般都在Parallel Desktop里进行开发，所以这里不讨论MacOS的情况，因为当前时空下仅有3Dmigoto作为后端，应用场景几乎都在Windows上，使用MacOS目前只能完成前端部分的开发，如有MacOS原生开发需求请提交PR完善相关代码和环境


# 基础架构

- Rust (https://rust-lang.org/)
- Tauri2 (https://v2.tauri.app/)
- Bun (https://bun.com/)
- Vite (https://vite.dev/)
- Vue3 (https://cn.vuejs.org/)
- TypeScript (https://www.typescriptlang.org/)

# 扩展组件

- Element Plus (https://element-plus.org/) (安装命令: `bun add element-plus`)

# VSCode插件
- rust-analyzer [Tauri]
- VUE(official) [Vue]
- Rust [The Rust Programming Language]

此外推荐使用 Github Copilot Pro , 10$每月的那个方案就够了，大幅度提升开发效率

# 构建用于发布的Build

一般情况需要两个步骤

`bun run build`

然后

`bun run tauri build`

但是实际操作中,`bun run tauri build`执行会预先调用 `bun run build`作为 Running beforeBuildCommand，所以步骤上可以少一步，因为一般tauri.conf.json中都会配置好`beforeBuildCommand`这个参数

所以最终答案是直接执行:

`bun run tauri build`

就可以打包出来了

注意第一次打包会安装一堆依赖，时间有点久，后面就快了

第一次打包安装依赖可能很慢，它在结尾会从GitHub下载一个巨大的wix package来安装，这玩意下载速度奇慢，记得设置GitHub走clash代理端口

```
git config --global http.proxy http://127.0.0.1:7890
git config --global https.proxy http://127.0.0.1:7890
```


实测这玩意39.4MB左右，如果不走代理能下到天荒地老，而且不显示下载进度，走代理的话1分钟左右就搞定了。

构建完成后，直接生成两个文件，放在了这个目录里

`src-tauri/target/release/bundle/`

子目录msi里有个.msi的安装包，子目录nsis里有个.exe的安装包

理论上能通过配置指定更多类型的安装包或者解压即用zip包，不过暂时懒得测试了，已经够用了。

# Build失败也是意料之中的嘛

毕竟是新架构，第一次进行构建失败肯定是我们还没有踩过这个坑

如下是不同环境上配置出现的问题

```
✓ 18 modules transformed.
dist/index.html                  0.49 kB │ gzip:  0.32 kB
dist/assets/index-BNVoTOhr.css   1.40 kB │ gzip:  0.66 kB
dist/assets/index-DZy4EZ2n.js   63.30 kB │ gzip: 25.45 kB
✓ built in 626ms
   Compiling ssmt4 v0.1.0 (D:\Dev\SSMT4\src-tauri)
    Finished `release` profile [optimized] target(s) in 28.88s
       Built application at: D:\Dev\SSMT4\src-tauri\target\release\ssmt4.exe
        Info Patching binary "D:\\Dev\\SSMT4\\src-tauri\\target\\release\\ssmt4.exe" for type msi
        Info Verifying wix package
 Downloading https://github.com/wixtoolset/wix3/releases/download/wix3141rtm/wix314-binaries.zip      
failed to bundle project `timeout: global`
       Error failed to bundle project `timeout: global`
error: script "tauri" exited with code 1

```

这种情况，我们之前已经设置了对GitHub的全局代理，但是根本不生效，咋办呢

这里的报错就是连接超时的问题。

我已经试过很多次了，设置代理根本不管用，下载速度要么慢的要死，要么像这样连接超时

干脆直接去掉wix的使用算了，wix本质上是能够把程序build为.msi安装包，但是实际使用中我们直接使用nsis生成的.exe安装包不也是一样的嘛？

在tauri.config.json中，我们把bunlde下面的 `"targets": "all"`

改为 `"targets": ["nsis"]`

因为nsis只有2.3MB左右，所以就算它后台真的很慢，也比将近40MB的快很多。

果然，在进行了3分钟的龟速等待后，nsis下载成功了，然后构建成功了

输出位置在`target/release/bundle/nsis/`下面，是一个exe的安装包

(而且可以去看wix的GitHub https://github.com/wixtoolset/wix3/，2025年2月就停更了，但是nsis-tauri-utils还在更新 https://github.com/tauri-apps/nsis-tauri-utils 所以秉持着新项目用新不用旧的原则，删掉wix也是很合理的)

